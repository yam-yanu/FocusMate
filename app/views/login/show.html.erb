<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=0.61">
		<title><%= content_for?(:title) ? yield(:title) : "FocusMate" %></title>
		<%= csrf_meta_tags %>

		<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
		<!--[if lt IE 9]>
			<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
		<![endif]-->

		<%= stylesheet_link_tag "application", :media => "all" %>

		<!-- For third-generation iPad with high-resolution Retina display: -->
		<!-- Size should be 144 x 144 pixels -->
		<%= favicon_link_tag 'apple-touch-icon-144x144-precomposed.png', :rel => 'apple-touch-icon-precomposed', :type => 'image/png', :sizes => '144x144' %>

		<!-- For iPhone with high-resolution Retina display: -->
		<!-- Size should be 114 x 114 pixels -->
		<%= favicon_link_tag 'apple-touch-icon-114x114-precomposed.png', :rel => 'apple-touch-icon-precomposed', :type => 'image/png', :sizes => '114x114' %>

		<!-- For first- and second-generation iPad: -->
		<!-- Size should be 72 x 72 pixels -->
		<%= favicon_link_tag 'apple-touch-icon-72x72-precomposed.png', :rel => 'apple-touch-icon-precomposed', :type => 'image/png', :sizes => '72x72' %>

		<!-- For non-Retina iPhone, iPod Touch, and Android 2.1+ devices: -->
		<!-- Size should be 57 x 57 pixels -->
		<%= favicon_link_tag 'apple-touch-icon-precomposed.png', :rel => 'apple-touch-icon-precomposed', :type => 'image/png' %>

		<!-- For all other devices -->
		<!-- Size should be 32 x 32 pixels -->
		<%= favicon_link_tag 'favicon.ico', :rel => 'shortcut icon' %>

		<%= javascript_include_tag "application" %>
		<script type="text/javascript">
			$(document).on('click','#form_open',function(e){
				e.preventDefault();
				$(".form_box").css("display","block");
			});
			$(document).on('click','.no_acount',function(){
				$("#user_name").parent("div").css("display","block");
				$("#user_password_confirmation").parent("div").css("display","block");
				$("#facebook-btn").html("<i class='fa fa-facebook'></i>Facebookで登録");
				$("#form_open").html("<i class='fa fa-envelope'></i>MailAddressで登録");
				$("#submit").val("登録");
				$("#login_form").attr("action", "/users");
				$("#submit").addClass('regist');
				$("#submit").removeClass('login');
				$(this).text("アカウントをもっている方");
				$(this).addClass('have_acount');
				$(this).removeClass('no_acount');
			});
			$(document).on('click','.have_acount',function(){
				$("#user_name").parent("div").css("display","none");
				$("#user_password_confirmation").parent("div").css("display","none");
				$("#facebook-btn").html("<i class='fa fa-facebook'></i>Facebookでログイン");
				$("#form_open").html("<i class='fa fa-envelope'></i>MailAddressでログイン");
				$("#submit").val("ログイン");
				$("#login_form").attr("action", "/users/sign_in");
				$("#submit").addClass('login');
				$("#submit").removeClass('regist');
				$(this).text("アカウントをもっていない方");
				$(this).addClass('no_acount');
				$(this).removeClass('have_acount');
			});
			$(document).on('click','.regist',function(){
				if(!$("#user_name").val() || !$("#user_email").val() || !$("#user_password").val() || !$("#user_password_confirmation").val()){
					alert("入力していない項目があります");
					return false;
				}
			});
			$(document).on('click','.login',function(){
				if(!$("#user_email").val() || !$("#user_password").val()){
					alert("入力していない項目があります");
					return false;
				}
				var form_data = {};
				form_data["email"] = $("#user_email").val();
				form_data["password"] = $("#user_password").val();
				$.ajax({
					type: 'post',
					url: '/users/sign_in',
					data: {user: form_data,
							authenticity_token: $("#authenticity_token").val()},
				}).done(function(result){
					if(result["result"]){
						location.reload();
					}else{
						$("#login_form").prepend('<div class="alert alert-dismissable alert-danger"><button type="button" class="close" data-dismiss="alert">×</button>メールアドレスかパスワードが<br>間違っているようです．</div>');
					}
				}).fail(function(result){
				});
				return false;
			});
		</script>
	</head>
	<body>
		<div class="navbar navbar-default navbar-fixed-top">
			<div class="navbar-header">
				<a class="navbar-brand" href="#">F<i style="font-size: 14px;" class="fa fa-search-plus"></i>cusMate</a>
			</div>

			<div class="navbar-collapse collapse navbar-responsive-collapse">

				<div class="navbar-form navbar-right input-group-sm" style="margin-right: 6px;">
					<%= link_to "<i class='fa fa-facebook'></i>Facebookでログイン/登録".html_safe, user_omniauth_authorize_path(:facebook), { :class => "btn btn-block btn-social btn-facebook", :style => "padding-left: 56px; margin-right: 10px;" } %>
				</div>
			</div>
		</div>

		<div class="container">
			<div class="row">
				<div class="col-md-3 col-sm-3 hidden-xs">
				</div>
				<div class="col-md-6 col-sm-6 col-xs-12" style="font-size: 25px; margin-top: 25px;padding-bottom: 15px;">
					FocusMateにようこそ
					<ul><blockquote>
						FocusMateでいつも生活しているグループメンバーの行動を褒めてみましょう。<br>
						自分の行動は書き込めません。
					</blockquote></ul>
<!--					 <%= bootstrap_flash %> -->
					<div class="col-xs-6" style="text-align:left;">
						<%= link_to "<i class='fa fa-facebook'></i>Facebookでログイン".html_safe, user_omniauth_authorize_path(:facebook), { :class => "btn btn-block btn-social btn-facebook", :id => "facebook-btn",:style => "width:100%;margin:30px 10px;" } %>
					</div>
					<div class="col-xs-6">
						<a class="btn btn-block btn-social btn-adn" id="form_open" href="#" style="width:100%;margin:30px 10px;"><i class="fa fa-envelope"></i>MailAddressでログイン</a>
					</div>
					<div class="row form_box" style="display:none;">
						<div class="col-md-2 col-sm-2 hidden-xs"></div>
						<div class="col-md-8 col-sm-8 col-xs-12">
							<form id="login_form" action="/users/sign_in" method="post" style="font-size: 18px;">
								<%= hidden_field_tag :authenticity_token, form_authenticity_token %>
								<div style="display:none;">
									名前
									<input autofocus="autofocus" id="user_name" class="form-control input-sm" name="user[name]"value=""/>
								</div>
								<div>
									メールアドレス
									<input id="user_email" class="form-control input-sm" name="user[email]" type="email" value="" />
								</div>
								<div>
									パスワード
									<input autocomplete="off" id="user_password" class="form-control input-sm" name="user[password]" type="password" />
								</div>
								<div style="display:none;" >
									パスワードの確認
									<input autocomplete="off" id="user_password_confirmation" class="form-control input-sm" name="user[password_confirmation]" type="password"/>
								</div>
								<div style="text-align:center;">
									<input type="submit" id="submit" class="btn btn-adn login" value="ログイン" />
								</div>
							</form>
						</div>
						<div class="col-md-2 col-sm-2 hidden-xs"></div>
					</div>
					<div class="no_acount">アカウントをもっていない方</div>
				</div>
				<div class="col-md-3 col-sm-3 hidden-xs">
				</div>
			</div><!--/row-->
		</div> <!-- /container -->

	</body>
</html>
