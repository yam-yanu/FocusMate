{"changed":false,"filter":false,"title":"groups_controller.rb","tooltip":"/app/controllers/groups_controller.rb","value":"class GroupsController < ApplicationController\n\tdef index\n\t\t@groups = Group.all.limit(10);\n\tend\n\n\tdef create\n\t\t@group = Group.new(group_params)\n\t\tif @group.save\n\t\t\tUser.where(\"id = '#{current_user.id}'\").update_all(\"group_id = '#{@group.id}'\")\n\t\tend\n\t\tredirect_to :controller => 'actions', :action => 'index'\n\tend\n\n\tdef change_group\n\t\tif current_user.group_id != 0\n\t\t\trender :js => \"alert('グループに入り直すことは出来ません.');\"\n\t\t\tdestroy_session_group_id\n\t\t\treturn\n\t\tend\n\t\tif session[:group_id]\n\t\t\tUser.where(\"id = '#{current_user.id}'\").update_all(\"group_id = '#{params[:group_id]}'\")\n\t\t\trender :js => \"$(location).attr('href', '/actions');show_loading();\"\n\t\t\tdestroy_session_group_id\n\t\telsif params[:group_id] && params[:password]\n\t\t\tpassword = Group.where(\"id = '#{params[:group_id]}'\")\n\t\t\tif password[0].password == params[:password]\n\t\t\t\tUser.where(\"id = '#{current_user.id}'\").update_all(\"group_id = '#{params[:group_id]}'\")\n\t\t\t\trender :js => \"$(location).attr('href', '/actions');show_loading();\"\n\t\t\telse\n\t\t\t\trender :js => \"alert('合言葉が違うようです.')\"\n\t\t\tend\n\t\telse\n\t\t\trender nothing: true\n\t\tend\n\t\tlogger.debug(\"fdsfasdfa\")\n\tend\n\n\tprivate\n\t\tdef group_params\n\t\t\tparams.permit(:name,:password,:detail)\n\t\tend\nend\n","undoManager":{"mark":-1,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":118.5,"scrollleft":0,"selection":{"start":{"row":33,"column":5},"end":{"row":33,"column":5},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":6,"state":"start","mode":"ace/mode/ruby"}},"timestamp":1412913913173}